•o
jC:\Users\hw72786\Source\Repos\OverWatcher\OverWatcher\OverWatcher.Common.HelperFuntions\HelperFunctions.cs
	namespace		 	
OverWatcher		
 
.		 
Common		 
.		 
HelperFunctions		 ,
{

 
public 

enum 
SortDirection 
{ 
ASC  #
,# $
DESC% )
}* +
;+ ,
public 

class 
HelperFunctions  
{ 
public 
static 
string 
SaveDataTableToCSV /
(/ 0
	DataTable0 9
dt: <
,< =
string> D
fileNamePostfxE S
)S T
{ 	
StringBuilder 
sb 
= 
new "
StringBuilder# 0
(0 1
)1 2
;2 3
IEnumerable 
< 
string 
> 
columnNames  +
=, -
dt. 0
.0 1
Columns1 8
.8 9
Cast9 =
<= >
System> D
.D E
DataE I
.I J

DataColumnJ T
>T U
(U V
)V W
.W X
Select. 4
(4 5
column5 ;
=>< >
WrapCSVCell? J
(J K
columnK Q
.Q R

ColumnNameR \
)\ ]
)] ^
;^ _
sb 
. 

AppendLine 
( 
string  
.  !
Join! %
(% &
$str& )
,) *
columnNames+ 6
)6 7
)7 8
;8 9
foreach 
( 
System 
. 
Data  
.  !
DataRow! (
row) ,
in- /
dt0 2
.2 3
Rows3 7
)7 8
{ 
IEnumerable 
< 
string "
>" #
fields$ *
=+ ,
row- 0
.0 1
	ItemArray1 :
.: ;
Select; A
(A B
fieldB G
=>H J
WrapCSVCellK V
(V W
fieldW \
.\ ]
ToString] e
(e f
)f g
)g h
)h i
;i j
sb 
. 

AppendLine 
( 
string $
.$ %
Join% )
() *
$str* -
,- .
fields/ 5
)5 6
)6 7
;7 8
} 
string 
savePath 
=  
ConfigurationManager 2
.2 3
AppSettings3 >
[> ?
$str? Q
]Q R
+S T
dtU W
.W X
	TableNameX a
+b c
fileNamePostfxd r
+s t
$stru {
;{ |
File 
. 
WriteAllText 
( 
savePath &
,& '
sb( *
.* +
ToString+ 3
(3 4
)4 5
)5 6
;6 7
return 
savePath 
; 
} 	
private 
static 
string 
WrapCSVCell )
() *
string* 0
cell1 5
)5 6
{   	
return!! 
cell!! 
.!! 
Contains!!  
(!!  !
$str!!! $
)!!$ %
?!!& '
$str!!) -
+!!. /
cell!!0 4
+!!5 6
$str!!7 ;
:!!< =
cell!!> B
;!!B C
}"" 	
public$$ 
static$$ 
void$$ 
SortDataTable$$ (
<$$( )
T$$) *
>$$* +
($$+ ,
	DataTable$$, 5
dt$$6 8
,$$8 9
string$$: @
colName$$A H
,$$H I
SortDirection$$J W
	direction$$X a
)$$a b
{%% 	
	DataTable&& 
tmp&& 
=&& 
dt&& 
.&& 
Clone&& $
(&&$ %
)&&% &
;&&& '
tmp'' 
.'' 
Columns'' 
['' 
colName'' 
]''  
.''  !
DataType''! )
=''* +
typeof'', 2
(''2 3
T''3 4
)''4 5
;''5 6
foreach(( 
((( 
DataRow(( 
dr(( 
in((  "
dt((# %
.((% &
Rows((& *
)((* +
{)) 
tmp** 
.** 
	ImportRow** 
(** 
dr**  
)**  !
;**! "
}++ 
tmp,, 
.,, 
DefaultView,, 
.,, 
Sort,,  
=,,! "
colName,,# *
+,,+ ,
$str,,- 0
+,,1 2
	direction,,3 <
;,,< =
dt-- 
.-- 
Clear-- 
(-- 
)-- 
;-- 
foreach.. 
(.. 
DataRow.. 
dr.. 
in.. !
tmp.." %
...% &
DefaultView..& 1
...1 2
ToTable..2 9
(..9 :
)..: ;
...; <
Rows..< @
)..@ A
{// 
dt00 
.00 
	ImportRow00 
(00 
dr00 
)00  
;00  !
}11 
}22 	
public44 
static44 
void44 
SortDataTable44 (
(44( )
	DataTable44) 2
dt443 5
,445 6
string447 =
colName44> E
,44E F
SortDirection44G T
	direction44U ^
)44^ _
{55 	
dt66 
.66 
DefaultView66 
.66 
Sort66 
=66  !
colName66" )
+66* +
$str66, /
+660 1
	direction662 ;
;66; <
var77 
tmp77 
=77 
dt77 
.77 
DefaultView77 $
.77$ %
ToTable77% ,
(77, -
)77- .
;77. /
dt88 
.88 
Clear88 
(88 
)88 
;88 
dt99 
.99 
Merge99 
(99 
tmp99 
)99 
;99 
}:: 	
public;; 
static;; 
	DataTable;; 
CSVToDataTable;;  .
(;;. /
string;;/ 5
strFilePath;;6 A
);;A B
{<< 	
	DataTable== 
dt== 
=== 
new== 
	DataTable== (
(==( )
)==) *
;==* +
dt>> 
.>> 
	TableName>> 
=>> 
Path>> 
.>>  '
GetFileNameWithoutExtension>>  ;
(>>; <
strFilePath>>< G
)>>G H
;>>H I
using?? 
(?? 
StreamReader?? 
sr??  "
=??# $
new??% (
StreamReader??) 5
(??5 6
strFilePath??6 A
)??A B
)??B C
{@@ 
stringAA 
[AA 
]AA 
headersAA  
=AA! "
CSVLineSpliterAA# 1
(AA1 2
srAA2 4
.AA4 5
ReadLineAA5 =
(AA= >
)AA> ?
)AA? @
;AA@ A
foreachBB 
(BB 
stringBB 
headerBB  &
inBB' )
headersBB* 1
)BB1 2
{CC 
dtDD 
.DD 
ColumnsDD 
.DD 
AddDD "
(DD" #
headerDD# )
)DD) *
;DD* +
}EE 
whileFF 
(FF 
!FF 
srFF 
.FF 
EndOfStreamFF &
)FF& '
{GG 
stringHH 
[HH 
]HH 
rowsHH !
=HH" #
CSVLineSpliterHH$ 2
(HH2 3
srHH3 5
.HH5 6
ReadLineHH6 >
(HH> ?
)HH? @
)HH@ A
;HHA B
DataRowII 
drII 
=II  
dtII! #
.II# $
NewRowII$ *
(II* +
)II+ ,
;II, -
forJJ 
(JJ 
intJJ 
iJJ 
=JJ  
$numJJ! "
;JJ" #
iJJ$ %
<JJ& '
headersJJ( /
.JJ/ 0
LengthJJ0 6
;JJ6 7
iJJ8 9
++JJ9 ;
)JJ; <
{KK 
drLL 
[LL 
iLL 
]LL 
=LL 
rowsLL  $
[LL$ %
iLL% &
]LL& '
;LL' (
}MM 
dtNN 
.NN 
RowsNN 
.NN 
AddNN 
(NN  
drNN  "
)NN" #
;NN# $
}OO 
}QQ 
returnTT 
dtTT 
;TT 
}UU 	
privateWW 
staticWW 
stringWW 
[WW 
]WW 
CSVLineSpliterWW  .
(WW. /
stringWW/ 5
lineWW6 :
)WW: ;
{XX 	
ListYY 
<YY 
stringYY 
>YY 
bufferYY 
=YY  !
newYY" %
ListYY& *
<YY* +
stringYY+ 1
>YY1 2
(YY2 3
)YY3 4
;YY4 5
boolZZ 
isQuotedZZ 
=ZZ 
falseZZ !
;ZZ! "
StringBuilder[[ 
stringBuffer[[ &
=[[' (
new[[) ,
StringBuilder[[- :
([[: ;
)[[; <
;[[< =
foreach\\ 
(\\ 
char\\ 
c\\ 
in\\ 
line\\ "
.\\" #
ToCharArray\\# .
(\\. /
)\\/ 0
)\\0 1
{]] 
if^^ 
(^^ 
c^^ 
==^^ 
$char^^ 
)^^ 
isQuoted^^ '
=^^( )
!^^* +
isQuoted^^+ 3
;^^3 4
else__ 
if__ 
(__ 
!__ 
isQuoted__ !
&&__" $
c__% &
==__' )
$char__* -
)__- .
{`` 
bufferaa 
.aa 
Addaa 
(aa 
stringBufferaa +
.aa+ ,
ToStringaa, 4
(aa4 5
)aa5 6
)aa6 7
;aa7 8
stringBufferbb  
.bb  !
Clearbb! &
(bb& '
)bb' (
;bb( )
}cc 
elsedd 
{ee 
stringBufferff  
.ff  !
Appendff! '
(ff' (
cff( )
)ff) *
;ff* +
}gg 
}ii 
returnjj 
bufferjj 
.jj 
ToArrayjj !
<jj! "
stringjj" (
>jj( )
(jj) *
)jj* +
;jj+ ,
}kk 	
}ll 
publicnn 

classnn 

Dictionarynn 
<nn 
TKey1nn !
,nn! "
TKey2nn# (
,nn( )
TValuenn* 0
>nn0 1
:nn2 3

Dictionarynn4 >
<nn> ?
Tuplenn? D
<nnD E
TKey1nnE J
,nnJ K
TKey2nnL Q
>nnQ R
,nnR S
TValuennT Z
>nnZ [
,nn[ \
IDictionarynn] h
<nnh i
Tuplenni n
<nnn o
TKey1nno t
,nnt u
TKey2nnv {
>nn{ |
,nn| }
TValue	nn~ Ñ
>
nnÑ Ö
{oo 
publicqq 
TValueqq 
thisqq 
[qq 
TKey1qq  
key1qq! %
,qq% &
TKey2qq' ,
key2qq- 1
]qq1 2
{rr 	
getss 
{ss 
returnss 
basess 
[ss 
Tupless #
.ss# $
Createss$ *
(ss* +
key1ss+ /
,ss/ 0
key2ss1 5
)ss5 6
]ss6 7
;ss7 8
}ss9 :
settt 
{tt 
basett 
[tt 
Tuplett 
.tt 
Creatett #
(tt# $
key1tt$ (
,tt( )
key2tt* .
)tt. /
]tt/ 0
=tt1 2
valuett3 8
;tt8 9
}tt: ;
}uu 	
publicww 
voidww 
Addww 
(ww 
TKey1ww 
key1ww "
,ww" #
TKey2ww$ )
key2ww* .
,ww. /
TValueww0 6
valueww7 <
)ww< =
{xx 	
baseyy 
.yy 
Addyy 
(yy 
Tupleyy 
.yy 
Createyy !
(yy! "
key1yy" &
,yy& '
key2yy( ,
)yy, -
,yy- .
valueyy/ 4
)yy4 5
;yy5 6
}zz 	
public|| 
bool|| 
ContainsKey|| 
(||  
TKey1||  %
key1||& *
,||* +
TKey2||, 1
key2||2 6
)||6 7
{}} 	
return~~ 
base~~ 
.~~ 
ContainsKey~~ #
(~~# $
Tuple~~$ )
.~~) *
Create~~* 0
(~~0 1
key1~~1 5
,~~5 6
key2~~7 ;
)~~; <
)~~< =
;~~= >
} 	
public
ÅÅ 
List
ÅÅ 
<
ÅÅ 
Tuple
ÅÅ 
<
ÅÅ 
TKey1
ÅÅ 
,
ÅÅ  
TKey2
ÅÅ! &
,
ÅÅ& '
TValue
ÅÅ( .
>
ÅÅ. /
>
ÅÅ/ 0
GetCollections
ÅÅ1 ?
(
ÅÅ? @
)
ÅÅ@ A
{
ÇÇ 	
return
ÉÉ 
this
ÉÉ 
.
ÉÉ 
Select
ÉÉ 
(
ÉÉ 
pair
ÉÉ #
=>
ÉÉ$ &
new
ÉÉ' *
Tuple
ÉÉ+ 0
<
ÉÉ0 1
TKey1
ÉÉ1 6
,
ÉÉ6 7
TKey2
ÉÉ8 =
,
ÉÉ= >
TValue
ÉÉ? E
>
ÉÉE F
(
ÉÉF G
pair
ÉÉG K
.
ÉÉK L
Key
ÉÉL O
.
ÉÉO P
Item1
ÉÉP U
,
ÉÉU V
pair
ÉÉW [
.
ÉÉ[ \
Key
ÉÉ\ _
.
ÉÉ_ `
Item2
ÉÉ` e
,
ÉÉe f
pair
ÉÉg k
.
ÉÉk l
Value
ÉÉl q
)
ÉÉq r
)
ÉÉr s
.
ÉÉs t
ToList
ÉÉt z
(
ÉÉz {
)
ÉÉ{ |
;
ÉÉ| }
}
ÑÑ 	
}
ÖÖ 
}ÜÜ ù
rC:\Users\hw72786\Source\Repos\OverWatcher\OverWatcher\OverWatcher.Common.HelperFuntions\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str <
)< =
]= >
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str >
)> ?
]? @
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *